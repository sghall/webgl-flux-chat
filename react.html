<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
    <link rel="stylesheet" href="css/chatapp.css">
    <style type="text/css">
      body {
        background-color: #19181B;
      }
    </style>
  </head>
  <body>
    <section id="react"></section>
    <script src="bower_components/react/react.js"></script>
    <script src="bower_components/threejs/build/three.js"></script>
    <script src="bower_components/d3/d3.js"></script>
    <script src="bower_components/tweenjs/build/tween.min.js"></script>
    <script src="../subunit/dist/subunit.js"></script>
    <script src="traceur/traceur.js"></script>
    <script src="traceur/bootstrap.js"></script>
    <script type="module">
      import { ChatApp } from './modules/components/ChatApp.react';
      import { exampleData } from './modules/exampleData';
      import { serverActions } from './modules/actions/server';
      import { view } from './modules/views/message';
      import { globeView } from './modules/views/globe';
      import { scene, camera, renderer } from './modules/scene';
      // setTimeout(function () {
      //   view.remove();
      // }, 3000)


      window.addEventListener('resize', onWindowResize, false);

      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize( window.innerWidth, window.innerHeight );
      }

      function animate() {
        // stats.update();
        // view.update();
        TWEEN.update();
        globeView.root.node().rotation.y += 0.02;

        requestAnimationFrame(animate);
        renderer.render(scene, camera);
      }

      animate();


      console.log("imported view", view);

      exampleData.init(); // load example data into localstorage

      var rawMessages = JSON.parse(localStorage.getItem('messages'));
      serverActions.receiveAll(rawMessages);

      React.render(  // No JSX here.
        React.createElement(ChatApp, null),
        document.getElementById('react')
      );

    </script>
  </body>
</html>